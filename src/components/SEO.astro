---
import { generateSEOTags, generateRobotsContent, generateSchemaScript, defaultSEO, siteConfig, type SEOProps } from '../lib/seo';

export interface Props extends SEOProps {}

const props = Astro.props as Props;

// Generate all SEO tags
const seoTags = generateSEOTags({ ...defaultSEO, ...props });
const robotsContent = generateRobotsContent(seoTags.robots);
const schemaScript = generateSchemaScript(seoTags.schema);
---

<!-- Basic Meta Tags -->
{seoTags.title && <title>{seoTags.title}</title>}
{seoTags.description && <meta name="description" content={seoTags.description} />}
{seoTags.canonical && <link rel="canonical" href={seoTags.canonical} />}

<!-- Robots -->
<meta name="robots" content={robotsContent} />
<meta name="googlebot" content="index,follow" />
<meta name="bingbot" content="index,follow" />

<!-- Sitemap for indexing -->
<link rel="sitemap" type="application/xml" href="/sitemap.xml" />

<!-- Additional SEO meta tags -->
<meta name="language" content="es" />
<meta name="revisit-after" content="7 days" />
<meta name="distribution" content="global" />
<meta name="rating" content="general" />

<!-- Theme and Viewport -->
<meta name="theme-color" content={siteConfig.themeColor} />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- Open Graph (Facebook/WhatsApp optimized) -->
<meta property="og:title" content={seoTags.ogTitle || seoTags.title || 'Iquitos Tech'} />
<meta property="og:description" content={seoTags.ogDescription || seoTags.description || 'Noticias de tecnología, gaming y tendencias digitales'} />
<meta property="og:type" content={seoTags.ogType || 'website'} />
<meta property="og:url" content={seoTags.ogUrl || seoTags.canonical || 'https://iquitostech.com'} />
<meta property="og:site_name" content={seoTags.ogSiteName || 'Iquitos Tech'} />
<meta property="og:locale" content={seoTags.ogLocale || 'es_ES'} />

<!-- Open Graph Image (required for Facebook/WhatsApp) -->
{seoTags.ogImage ? (
  <>
    <meta property="og:image" content={seoTags.ogImage} />
    <meta property="og:image:secure_url" content={seoTags.ogImage} />
    {seoTags.ogImageWidth && <meta property="og:image:width" content={seoTags.ogImageWidth.toString()} />}
    {seoTags.ogImageHeight && <meta property="og:image:height" content={seoTags.ogImageHeight.toString()} />}
    {seoTags.ogImageType && <meta property="og:image:type" content={seoTags.ogImageType} />}
    <meta property="og:image:alt" content={seoTags.ogTitle || 'Iquitos Tech'} />
  </>
) : (
  <>
    <meta property="og:image" content="https://iquitostech.com/image1.jpg" />
    <meta property="og:image:secure_url" content="https://iquitostech.com/image1.jpg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:type" content="image/jpeg" />
    <meta property="og:image:alt" content="Iquitos Tech - Noticias de Tecnología" />
  </>
)}

<!-- Article Meta (for blog posts) -->
{seoTags.ogType === 'article' && (
  <>
    {seoTags.articlePublishedTime && <meta property="article:published_time" content={seoTags.articlePublishedTime} />}
    {seoTags.articleModifiedTime && <meta property="article:modified_time" content={seoTags.articleModifiedTime} />}
    {seoTags.articleAuthor && <meta property="article:author" content={seoTags.articleAuthor} />}
    <meta property="article:section" content="Tecnología" />
    <meta property="article:tag" content="tecnología" />
    <meta property="article:tag" content="gaming" />
  </>
)}

<!-- Facebook App ID (helps with debugging) -->
<meta property="fb:app_id" content="622554630894859" />

<!-- Additional Open Graph for better Facebook/WhatsApp support -->
<meta property="og:updated_time" content={seoTags.articleModifiedTime || new Date().toISOString()} />

<!-- Twitter Cards -->
{seoTags.twitterCard && <meta name="twitter:card" content={seoTags.twitterCard} />}
{seoTags.twitterSite && <meta name="twitter:site" content={seoTags.twitterSite} />}
{seoTags.twitterCreator && <meta name="twitter:creator" content={seoTags.twitterCreator} />}
{seoTags.ogTitle && <meta name="twitter:title" content={seoTags.ogTitle} />}
{seoTags.ogDescription && <meta name="twitter:description" content={seoTags.ogDescription} />}
{seoTags.ogImage && <meta name="twitter:image" content={seoTags.ogImage} />}

<!-- Twitter Labels (for rich snippets) -->
{seoTags.twitterLabel1 && seoTags.twitterData1 && (
  <>
    <meta name="twitter:label1" content={seoTags.twitterLabel1} />
    <meta name="twitter:data1" content={seoTags.twitterData1} />
  </>
)}
{seoTags.twitterLabel2 && seoTags.twitterData2 && (
  <>
    <meta name="twitter:label2" content={seoTags.twitterLabel2} />
    <meta name="twitter:data2" content={seoTags.twitterData2} />
  </>
)}

<!-- JSON-LD Schema -->
{schemaScript && (
  <script type="application/ld+json" set:html={schemaScript}></script>
)}

<!-- Additional Meta -->
<meta name="author" content={seoTags.articleAuthor || 'Iquitos Tech'} />
<meta name="generator" content={Astro.generator} />

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
<link rel="icon" type="image/svg+xml" href="/logo.svg" />
